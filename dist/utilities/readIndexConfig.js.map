{"version":3,"file":"readIndexConfig.js","names":["directoryPath","options","hasIndex","indexPath","path","resolve","outputFile","indexContents","fs","readFileSync","found","match","CREATE_INDEX_PATTERN","configLine","trim","length","config","JSON","parse","err","Error"],"sources":["../../src/utilities/readIndexConfig.js"],"sourcesContent":["/**\n * @author    Adrian Stokes <adrian@anstech.co.uk>\n * @company   ANSTECH Limited\n * @copyright 2023 ANSTECH Limited\n * @license   None, all rights reserved\n */\n\nimport fs from 'fs';\nimport path from 'path';\n\nimport hasIndex from './hasIndex';\n\nimport { CREATE_INDEX_PATTERN } from './constants';\n\nexport default (directoryPath, options = {}) => {\n  if (!hasIndex(directoryPath, options)) {\n    return {};\n  }\n\n  const indexPath = path.resolve(directoryPath, options.outputFile || 'index.js');\n  const indexContents = fs.readFileSync(indexPath, 'utf-8');\n  const found = indexContents.match(CREATE_INDEX_PATTERN);\n  const configLine = typeof found[1] === 'string' ? found[1].trim() : '';\n\n  if (configLine.length === 0) {\n    return {};\n  }\n\n  let config;\n\n  try {\n    config = JSON.parse(configLine);\n  } catch (err) {\n    throw new Error(\n      `\"${indexPath}\" contains invalid configuration object.\\n\n      Configuration object must be a valid JSON.`,\n    );\n  }\n\n  return config;\n};\n"],"mappings":";;;;;;AAOA;AACA;AAEA;AAEA;AAAmD;AAZnD;AACA;AACA;AACA;AACA;AACA;AALA,eAce,kBAACA,aAAa,EAAmB;EAAA,IAAjBC,OAAO,uEAAG,CAAC,CAAC;EACzC,IAAI,CAAC,IAAAC,iBAAQ,EAACF,aAAa,EAAEC,OAAO,CAAC,EAAE;IACrC,OAAO,CAAC,CAAC;EACX;EAEA,MAAME,SAAS,GAAGC,aAAI,CAACC,OAAO,CAACL,aAAa,EAAEC,OAAO,CAACK,UAAU,IAAI,UAAU,CAAC;EAC/E,MAAMC,aAAa,GAAGC,WAAE,CAACC,YAAY,CAACN,SAAS,EAAE,OAAO,CAAC;EACzD,MAAMO,KAAK,GAAGH,aAAa,CAACI,KAAK,CAACC,+BAAoB,CAAC;EACvD,MAAMC,UAAU,GAAG,OAAOH,KAAK,CAAC,CAAC,CAAC,KAAK,QAAQ,GAAGA,KAAK,CAAC,CAAC,CAAC,CAACI,IAAI,EAAE,GAAG,EAAE;EAEtE,IAAID,UAAU,CAACE,MAAM,KAAK,CAAC,EAAE;IAC3B,OAAO,CAAC,CAAC;EACX;EAEA,IAAIC,MAAM;EAEV,IAAI;IACFA,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC;EACjC,CAAC,CAAC,OAAOM,GAAG,EAAE;IACZ,MAAM,IAAIC,KAAK,CACZ,IAAGjB,SAAU;AACpB,iDAAiD,CAC5C;EACH;EAEA,OAAOa,MAAM;AACf,CAAC;AAAA"}