{"version":3,"file":"validateTargetDirectory.js","names":["targetDirectory","options","silent","stats","fs","statSync","err","Error","isDirectory","indexFilePath","path","resolve","outputFile","indexFile","readFileSync","match","CREATE_INDEX_PATTERN"],"sources":["../../src/utilities/validateTargetDirectory.js"],"sourcesContent":["/**\n * @author    Adrian Stokes <adrian@anstech.co.uk>\n * @company   ANSTECH Limited\n * @copyright 2023 ANSTECH Limited\n * @license   None, all rights reserved\n */\n\nimport fs from 'fs';\nimport path from 'path';\nimport { CREATE_INDEX_PATTERN } from './constants';\n\nexport default (targetDirectory, options = {}) => {\n  const { silent } = options;\n  let stats;\n\n  try {\n    stats = fs.statSync(targetDirectory);\n  } catch (err) {\n    if (silent) {\n      return false;\n    }\n    throw new Error(`Directory \"${targetDirectory}\" does not exist.`);\n  }\n\n  if (!stats.isDirectory()) {\n    if (silent) {\n      return false;\n    }\n    throw new Error(`\"${targetDirectory}\" is not a directory.`);\n  }\n\n  const indexFilePath = path.resolve(targetDirectory, `./${options.outputFile || 'index.js'}`);\n\n  try {\n    fs.statSync(indexFilePath);\n  } catch (err) {\n    return true;\n  }\n\n  const indexFile = fs.readFileSync(indexFilePath, 'utf8');\n\n  if (!indexFile.match(CREATE_INDEX_PATTERN)) {\n    if (silent) {\n      return false;\n    }\n    throw new Error(`\"${indexFilePath}\" unsafe index.`);\n  }\n\n  return true;\n};\n"],"mappings":";;;;;;AAOA;AACA;AACA;AAAmD;AATnD;AACA;AACA;AACA;AACA;AACA;AALA,eAWe,kBAACA,eAAe,EAAmB;EAAA,IAAjBC,OAAO,uEAAG,CAAC,CAAC;EAC3C,MAAQC,MAAM,GAAKD,OAAO,CAAlBC,MAAM;EACd,IAAIC,KAAK;EAET,IAAI;IACFA,KAAK,GAAGC,WAAE,CAACC,QAAQ,CAACL,eAAe,CAAC;EACtC,CAAC,CAAC,OAAOM,GAAG,EAAE;IACZ,IAAIJ,MAAM,EAAE;MACV,OAAO,KAAK;IACd;IACA,MAAM,IAAIK,KAAK,CAAE,cAAaP,eAAgB,mBAAkB,CAAC;EACnE;EAEA,IAAI,CAACG,KAAK,CAACK,WAAW,EAAE,EAAE;IACxB,IAAIN,MAAM,EAAE;MACV,OAAO,KAAK;IACd;IACA,MAAM,IAAIK,KAAK,CAAE,IAAGP,eAAgB,uBAAsB,CAAC;EAC7D;EAEA,MAAMS,aAAa,GAAGC,aAAI,CAACC,OAAO,CAACX,eAAe,EAAG,KAAIC,OAAO,CAACW,UAAU,IAAI,UAAW,EAAC,CAAC;EAE5F,IAAI;IACFR,WAAE,CAACC,QAAQ,CAACI,aAAa,CAAC;EAC5B,CAAC,CAAC,OAAOH,GAAG,EAAE;IACZ,OAAO,IAAI;EACb;EAEA,MAAMO,SAAS,GAAGT,WAAE,CAACU,YAAY,CAACL,aAAa,EAAE,MAAM,CAAC;EAExD,IAAI,CAACI,SAAS,CAACE,KAAK,CAACC,+BAAoB,CAAC,EAAE;IAC1C,IAAId,MAAM,EAAE;MACV,OAAO,KAAK;IACd;IACA,MAAM,IAAIK,KAAK,CAAE,IAAGE,aAAc,iBAAgB,CAAC;EACrD;EAEA,OAAO,IAAI;AACb,CAAC;AAAA"}